# üöÄ CLI Deployment Guide - Fresh Start

**Total Time**: ~15 minutes | **Cost**: $0/month ‚úÖ

This guide uses CLI tools for automated, reliable deployment.

---

## üìã **Prerequisites**

- Node.js installed (`node -v`)
- GitHub account with your repo
- Render account
- Netlify account

---

## **STEP 1: Install CLI Tools**

Run these commands in PowerShell:

```powershell
npm install -g @render-cli/cli
npm install -g netlify-cli
```

Verify installation:
```powershell
render --version
netlify --version
```

---

## **STEP 2: Authenticate with Render**

```powershell
render login
```

A browser window will open. Sign in with your Render account and authorize the CLI.

---

## **STEP 3: Authenticate with Netlify**

```powershell
netlify login
```

A browser window will open. Sign in with your Netlify account and authorize the CLI.

---

## **STEP 4: Deploy Backend & Database to Render**

The `render.yaml` file in your repo defines your entire infrastructure. Deploy it:

```powershell
render deploy
```

This will:
1. ‚úÖ Create PostgreSQL database (`attendance-db`)
2. ‚úÖ Deploy backend service (`attendance-system-api`)
3. ‚úÖ Set up environment variables automatically

**Wait 3-5 minutes** for deployment to complete.

Get your backend URL:
```powershell
render services
```

Copy the backend service URL (e.g., `https://attendance-system-xxxx.onrender.com`)

---

## **STEP 5: Deploy Frontend to Netlify**

```powershell
netlify deploy --prod --dir=client/build
```

If this is your first time:
1. Choose "Create & configure a new site"
2. Enter site name: `attendance-system`
3. Build command: `cd client && npm install && npm run build`
4. Publish directory: `client/build`

**Wait 2-3 minutes** for deployment to complete.

Get your frontend URL from the output (e.g., `https://attendance-system.netlify.app`)

---

## **STEP 6: Set Frontend Environment Variable in Netlify**

Update Netlify with your backend URL:

```powershell
netlify env:set REACT_APP_API_URL https://your-backend-url.onrender.com
```

Replace `https://your-backend-url.onrender.com` with your actual backend URL from Step 4.

---

## **STEP 7: Redeploy Frontend with Environment Variable**

```powershell
netlify deploy --prod --dir=client/build
```

---

## **STEP 8: Initialize Admin User**

Create the admin user in your PostgreSQL database:

```powershell
node create-admin.js
```

Wait for the success message.

---

## **STEP 9: Test Your System**

1. Open your Netlify frontend URL
2. Login with:
   - **Email**: `admin@attendance.local`
   - **Password**: `Admin@123456`
3. You should see the dashboard!

---

## üéâ **You're Live!**

| Component | Status |
|-----------|--------|
| Frontend | ‚úÖ Live on Netlify |
| Backend | ‚úÖ Live on Render |
| Database | ‚úÖ PostgreSQL on Render |
| Admin User | ‚úÖ Created |

---

## üìù **Useful CLI Commands**

View all services:
```powershell
render services
```

View logs:
```powershell
render logs --service attendance-system-api
```

Deploy again:
```powershell
render deploy
```

View Netlify site info:
```powershell
netlify sites:list
```

---

## ‚ùå **Troubleshooting**

### Backend won't deploy
- Check logs: `render logs --service attendance-system-api`
- Verify `render.yaml` syntax
- Ensure GitHub repo is up to date

### Frontend won't deploy
- Check build logs in Netlify dashboard
- Verify `REACT_APP_API_URL` is set correctly
- Try: `netlify deploy --prod --dir=client/build`

### Login fails
- Check backend is running: Visit backend URL `/api/health`
- Verify admin user was created
- Check browser console for CORS errors

---

## üîê **Security Notes**

- Change default admin password after first login
- Keep JWT_SECRET secret (auto-generated by Render)
- Use strong passwords for new users
- Enable HTTPS (automatic with Render & Netlify)

